<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventário de Equipamentos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <h2>Inventário de Equipamentos</h2>
        <form id="equipForm" class="row g-3 mb-4">
            <div class="col-md-2">
                <input type="text" class="form-control" id="modelo" placeholder="Modelo" required>
            </div>
            <div class="col-md-2">
                <input type="text" class="form-control" id="serie" placeholder="Nº serie" required>
            </div>
            <div class="col-md-2">
                <select class="form-select" id="categoria" onchange="checkCategory()">
                    <option selected>Escolher...</option>
                    <option value="Imagem">Imagem</option>
                    <option value="Dispositivo Entrada">Dispositivo Entrada</option>
                    <option value="Wireless">Wireless</option>
                    <option value="Computador">Computador</option>
                    <option value="Outro">Outro</option>
                </select>
                <input type="text" class="form-control mt-2" id="categoriaOutro" placeholder="Digite a categoria" style="display: none;">
            </div>
            <div class="col-md-1">
                <input type="text" class="form-control" id="monitor" placeholder="Monitor">
            </div>
            <div class="col-md-1">
                <input type="text" class="form-control" id="rato" placeholder="Rato">
            </div>
            <div class="col-md-1">
                <input type="text" class="form-control" id="teclado" placeholder="Teclado">
            </div>
            <div class="col-md-1">
                <input type="text" class="form-control" id="router" placeholder="Router">
            </div>
            <div class="col-md-1">
                <input type="text" class="form-control" id="torre" placeholder="Torre">
            </div>
            <div class="col-md-1">
                <input type="text" class="form-control" id="ap" placeholder="AP">
            </div>
            <div class="col-md-1">
                <input type="text" class="form-control" id="utilizador" placeholder="Utilizador" required>
            </div>
            <div class="col-md-1">
                <input type="text" class="form-control" id="localizacao" placeholder="Localização" required>
            </div>
            <div class="col-md-2">
                <button type="submit" class="btn btn-success">Adicionar</button>
            </div>
        </form>

        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Modelo</th>
                    <th>Nº Série</th>
                    <th>Categoria</th>
                    <th>Monitor</th>
                    <th>Rato</th>
                    <th>Teclado</th>
                    <th>Router</th>
                    <th>Torre</th>
                    <th>AP</th>
                    <th>Utilizador</th>
                    <th>Localização</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody id="tableBody">
            </tbody>
        </table>
        <button class="btn btn-primary" onclick="exportTableToCSV('inventario.csv')">Exportar para Excel</button>
    </div>
    
    <script src="https```js
// Função para verificar se o campo está vazio e substituir por "S/R"
function checkEmpty(value) {
    return value.trim() === "" ? "S/R" : value;
}

// Função para adicionar as informações do formulário à tabela
document.getElementById("equipForm").addEventListener("submit", function(event) {
    event.preventDefault();

    // Obter os valores inseridos
    var modelo = document.getElementById("modelo").value;
    var serie = document.getElementById("serie").value;
    var categoria = document.getElementById("categoria").value;
    var monitor = document.getElementById("monitor").value;
    var rato = document.getElementById("rato").value;
    var teclado = document.getElementById("teclado").value;
    var router = document.getElementById("router").value;
    var torre = document.getElementById("torre").value;
    var ap = document.getElementById("ap").value;
    var utilizador = document.getElementById("utilizador").value;
    var localizacao = document.getElementById("localizacao").value;

    // Verificar se os campos estão vazios e substituir por "S/R"
    modelo = checkEmpty(modelo);
    serie = checkEmpty(serie);
    categoria = categoria === "Escolher..." ? "S/R" : categoria;
    monitor = checkEmpty(monitor);
    rato = checkEmpty(rato);
    teclado = checkEmpty(teclado);
    router = checkEmpty(router);
    torre = checkEmpty(torre);
    ap = checkEmpty(ap);
    utilizador = checkEmpty(utilizador);
    localizacao = checkEmpty(localizacao);

    // Adicionar uma nova linha na tabela
    var table = document.getElementById("tableBody");
    var newRow = table.insertRow(-1);
    newRow.innerHTML = `
        <td>${modelo}</td>
        <td>${serie}</td>
        <td>${categoria}</td>
        <td>${monitor}</td>
        <td>${rato}</td>
        <td>${teclado}</td>
        <td>${router}</td>
        <td>${torre}</td>
        <td>${ap}</td>
        <td>${utilizador}</td>
        <td>${localizacao}</td>
        <td><button onclick="removeRow(this)">Remover</button></td>
    `;
});

// Função para remover uma linha da tabela
function removeRow(button) {
    var row = button.parentNode.parentNode;
    row.parentNode.removeChild(row);
}

// Função para exportar a tabela para CSV
function exportTableToCSV(filename) {
    var csv = [];
    var rows = document.querySelectorAll("table tr");

    for (var i = 0; i < rows.length; i++) {
        var row = [], cols = rows[i].querySelectorAll("td, th");

        for (var j = 0; j < cols.length; j++) 
            row.push('"' + cols[j].innerText + '"');

        csv.push(row.join(","));
    }

    downloadCSV(csv.join("\n"), filename);
}

// Função para baixar o arquivo CSV
function downloadCSV(csv, filename) {
    var csvFile;
    var downloadLink;

    csvFile = new Blob([csv], {type: "text/csv"});
    downloadLink = document.createElement("a");
    downloadLink.download = filename;
    downloadLink.href = window.URL.createObjectURL(csvFile);
    downloadLink.style.display = "none";
    document.body.appendChild(downloadLink);
    downloadLink.click();
}
</script>
</body>
</html>
