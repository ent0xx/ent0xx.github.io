<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventário de Equipamentos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <h2>Inventário de Equipamentos</h2>
        <form id="equipForm" class="row g-3 mb-4">
            <div class="col-md-2">
                <input type="text" class="form-control" id="modelo" placeholder="Modelo" required>
            </div>
            <div class="col-md-2">
                <input type="text" class="form-control" id="serie" placeholder="Nº serie" required>
            </div>
            <div class="col-md-2">
                <select class="form-select" id="categoria" onchange="checkCategory()">
                    <option selected>Escolher...</option>
                    <option value="Imagem">Imagem</option>
                    <option value="Dispositivo Entrada">Dispositivo Entrada</option>
                    <option value="Wireless">Wireless</option>
                    <option value="Computador">Computador</option>
                    <option value="Outro">Outro</option>
                </select>
                <input type="text" class="form-control mt-2" id="categoriaOutro" placeholder="Digite a categoria" style="display: none;">
            </div>
            <div class="col-md-1">
                <input type="text" class="form-control" id="monitor" placeholder="Monitor">
            </div>
            <div class="col-md-1">
                <input type="text" class="form-control" id="rato" placeholder="Rato">
            </div>
            <div class="col-md-1">
                <input type="text" class="form-control" id="teclado" placeholder="Teclado">
            </div>
            <div class="col-md-1">
                <input type="text" class="form-control" id="router" placeholder="Router">
            </div>
            <div class="col-md-1">
                <input type="text" class="form-control" id="torre" placeholder="Torre">
            </div>
            <div class="col-md-1">
                <input type="text" class="form-control" id="ap" placeholder="AP">
            </div>
            <div class="col-md-1">
                <input type="text" class="form-control" id="utilizador" placeholder="Utilizador" required>
            </div>
            <div class="col-md-1">
                <input type="text" class="form-control" id="localizacao" placeholder="Localização" required>
            </div>
            <div class="col-md-2">
                <button type="submit" class="btn btn-success">Adicionar</button>
            </div>
        </form>

        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Modelo</th>
                    <th>Nº Série</th>
                    <th>Categoria</th>
                    <th>Monitor</th>
                    <th>Rato</th>
                    <th>Teclado</th>
                    <th>Router</th>
                    <th>Torre</th>
                    <th>AP</th>
                    <th>Utilizador</th>
                    <th>Localização</th>
                    <th>Ações</th>
                </tr>
            </thead>
            <tbody id="tableBody">
            </tbody>
        </table>
        <button class="btn btn-primary" onclick="exportTableToCSV('inventario.csv')">Exportar para Excel</button>
    </div>
    
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
```javascript
    <script>
        document.getElementById('equipForm').addEventListener('submit', function(event) {
            event.preventDefault();
            const table = document.getElementById('tableBody');
            const row = table.insertRow();
            const fields = ['modelo', 'serie', 'categoria', 'monitor', 'rato', 'teclado', 'router', 'torre', 'ap', 'utilizador', 'localizacao'];
            fields.forEach(function(field) {
                const cell = row.insertCell();
                if (field === 'categoria' && document.getElementById('categoria').value === 'Outro') {
                    cell.textContent = document.getElementById('categoriaOutro').value;
                } else {
                    cell.textContent = document.getElementById(field).value;
                }
                document.getElementById(field).value = ''; // Clear the form field after adding
            });
            document.getElementById('categoria').value = 'Escolher...'; // Reset dropdown
            document.getElementById('categoriaOutro').style.display = 'none'; // Hide the 'Outro' input field
            const deleteBtn = row.insertCell();
            deleteBtn.innerHTML = '<button class="btn btn-danger btn-sm" onclick="deleteRow(this)">Eliminar</button>';
        });

        function deleteRow(btn) {
            const row = btn.parentNode.parentNode;
            row.parentNode.removeChild(row);
        }

        function checkCategory() {
            const categorySelect = document.getElementById('categoria');
            const outroInput = document.getElementById('categoriaOutro');
            if (categorySelect.value === 'Outro') {
                outroInput.style.display = 'block';
            } else {
                outroInput.style.display = 'none';
            }
        }

        function downloadCSV(csv, filename) {
            let csvFile;
            let downloadLink;
            csvFile = new Blob([csv], {type: "text/csv"});
            downloadLink = document.createElement("a");
            downloadLink.download = filename;
            downloadLink.href = window.URL.createObjectURL(csvFile);
            downloadLink.style.display = "none";
            document.body.appendChild(downloadLink);
            downloadLink.click();
        }

        function exportTableToCSV(filename) {
            var csv = [];
            var rows = document.querySelectorAll("table tr");
            for (var i = 0; i < rows.length; i++) {
                var row = [], cols = rows[i].querySelectorAll("td, th");
                for (var j = 0; j < cols.length; j++) 
                    row.push('"' + cols[j].innerText + '"');
                csv.push(row.join(","));
            }
            downloadCSV(csv.join("\n"), filename);
        }
    </script>
</body>
</html>
